# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data
Let's call the variable "activity". "activity_clear" contains no NAs.
```{r}
activity = read.csv("activity.csv")
activity_clear = subset(activity, !is.na(activity$steps))
```

## What is mean total number of steps taken per day?
Mean is low, but non-zero, while median is exactly zero. Most days have no activity at all.
```{r}
hist(x = activity_clear$steps, col="blue", xlab="Total Steps a Day (with cleared NAs)", ylab="Number of days with such frequancy")
mean(activity_clear$steps)
median(activity_clear$steps)

```

## What is the average daily activity pattern?
The most activity is observed aroun 8:35 a.m.
```{r}
intervals = unique(activity_clear$interval)
av_act = c()
for (i in 1:length(intervals)){
    interval_values = subset(activity_clear, activity_clear$interval == intervals[i])
    av_int = mean(interval_values$steps)
    av_act = c(av_act, av_int)
    }

plot(x = intervals, y = av_act, type="l", ylab="Average number of steps in interval across all days", xlab="Time intervals, where 2000 means 20:00 - 20:05")

maxint = which.max(av_act)
intervals[maxint]
av_act[maxint]
```

## Imputing missing values
Replacing NAs with the average value for the time interval. No changed is averages observed.
```{r}
number_of_missings = sum(is.na(activity$steps))



activity_full = activity
for (i in 1:length(activity_full$steps)){
    if (is.na(activity_full$steps[i])){
        interval_number = which(intervals == activity_full$interval[i])
        activity_full$steps[i] = av_act[interval_number]
        }
    }

hist(x = activity_full$steps, col="blue", xlab="Total Steps a Day (with filled NAs)", ylab="Number of days with such frequancy")
mean(activity_full$steps)
median(activity_full$steps)

```


## Are there differences in activity patterns between weekdays and weekends?

for (i in 1:length(activity_full$steps)){
    if (activity_full){
        interval_number = which(intervals == activity_full$interval[i])
        activity_full$steps[i] = av_act[interval_number]
        }
    }

